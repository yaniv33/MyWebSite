<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice 4.1.11  (Win32)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Yaniv Mano">
	<META NAME="CHANGED" CONTENT="20221225;15452171">
	<META NAME="CHANGEDBY" CONTENT="Yaniv Mano">
	<META NAME="CHANGEDBY" CONTENT="Yaniv Mano">
	<META NAME="CHANGEDBY" CONTENT="Yaniv Mano">
	<STYLE TYPE="text/css">
	<!--
		PRE.cjk { font-family: "NSimSun", monospace }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<PRE CLASS="western" STYLE="margin-left: 1.16cm">https://www.youtube.com/watch?v=sm-8qfMWEV8&amp;list=PLqq-6Pq4lTTYTEooakHchTGglSvkZAjnE


TOPICS TO COVER 
ldap , json , cros


<FONT SIZE=3 STYLE="font-size: 13pt"><U><B>CONFIGURE SPRING SECURITY</B></U></FONT>

<U><SPAN STYLE="background: #ffff00">1.POM SECURITY STARTER</SPAN></U>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U>&lt;<FONT COLOR="#0033b3">dependency</FONT>&gt;</U></FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;org.springframework.boot&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;spring-boot-starter-security&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;/<FONT COLOR="#0033b3">dependency</FONT>&gt;</FONT></FONT></FONT>
<U><SPAN STYLE="background: #ffff00">2.SPRING BOOT START UP</SPAN></U>

<FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@SpringBootApplication</FONT></FONT></FONT><FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>(scanBasePackages = {</FONT></FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;com.example.securityBasics&quot;</FONT></FONT></FONT><FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>, </FONT></FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DECLALE LOCATIONS TO SREACH SPRING FILES</I></FONT></FONT></FONT>
<FONT COLOR="#080808">                                           <FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;com.example.springbootdemo&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>})</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@RestController                                                          </FONT><FONT COLOR="#8c8c8c"><I>// ADD THIS TO CREATE REST CONTROLLER</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@EnableWebSecurity                                                       </FONT><FONT COLOR="#8c8c8c"><I>// THIS WILL CREATE A LOGIN PAGE !!</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@EntityScan</FONT>(<FONT COLOR="#067d17">&quot;com.example.securityBasics&quot;</FONT>)                                <FONT COLOR="#8c8c8c"><I>// THIS SCAN ENTITY </I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@EnableJpaRepositories</FONT>(basePackageClasses = <FONT COLOR="#000000">UserRepository</FONT>.<FONT COLOR="#0033b3">class</FONT>)        <FONT COLOR="#8c8c8c"><I>// THIS ALLOW ACCESS TO DB WITH JPA</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000">SpringBootDemoApplication </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public static void </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>main</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>[] args) {</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>ConfigurableApplicationContext context  </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>SpringApplication</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>run</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>SpringBootDemoApplication</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>class</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>, args);</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>//    Alian a = context.getBean(Alian.class);  // WOULD ONLY WORK IF Alian declared as @component</I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">  </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<U><SPAN STYLE="background: #ffff00">3.CONFIGURE SECURITY OLD </SPAN></U>

<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d"><I>@EnableWebSecurity </I></FONT><FONT COLOR="#8c8c8c"><I>// this is a web security configuration</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000">SecurityConfigurationOld </FONT><FONT COLOR="#0033b3">extends </FONT>WebSecurityConfigurerAdapter{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO AUTHENTICATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Override</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>protected void </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>configure</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>AuthenticationManagerBuilder </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>auth) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Exception </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>{ </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// deals with authentication</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">        </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>auth.jdbcAuthentication().</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>dataSource(dataSource.dataSource())                             </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>//SET DATABASE SOURCE</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">                </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.usersByUsernameQuery(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;SELECT username, password, enabled&quot; </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>+    </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// QUERY FOR USERS</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">                                                </FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot; FROM musers WHERE username =  ?&quot; </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>.authoritiesByUsernameQuery(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;SELECT username, authority&quot; </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>+     </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// QUERY FOR AUTHORIZED USERS</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">                                                </FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot; FROM authorities WHERE username =  ?&quot; </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO AUTHORIZATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Override</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>protected void </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>configure</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>HttpSecurity </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>http) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Exception </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>{ </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// deals with authorization</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">        </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>http.authorizeRequests().</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>antMatchers(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;/admin&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).hasRole(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ADMIN&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).           </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// IF PATH HOLDS matcher allow to role</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">                </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>antMatchers(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;/user&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).hasAnyRole(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;USER&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>, </FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ADMIN&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>). </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// &quot;/**&quot; wild card</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">                </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>antMatchers(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;/&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).permitAll().                     </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// else permit all</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">                </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>and().formLogin();</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO </I></FONT></FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I><SPAN STYLE="background: #ccffff">ENCODING</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Bean</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>PasswordEncoder </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>getPasswordEncoder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(){</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>NoOpPasswordEncoder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>getInstance</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(); </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// this is a clear text encoding password</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<U><SPAN STYLE="background: #ffff00">3.CONFIGURE SECURITY NEW</SPAN></U>

<FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: transparent">@Configuration</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@EnableWebSecurity </FONT><FONT COLOR="#8c8c8c"><I>// this is a web security configuration</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000">SecurityConfiguration </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO AUTHENTICATION IN MEMORY</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Bean  </FONT></FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// !! THIS IN MEMORY WOULD ONLY WORK IF NO CLASS IMPLEMENTS UserDetailsService (in MyUserDetailsService) !!</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>InMemoryUserDetailsManager </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>inMemoryUserDetailsManager</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(){</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>List</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>UserDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt; </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>ArrayList&lt;&gt;();</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.add(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>User</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>withUsername</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;admin&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).password(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;pass&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).roles(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ADMIN&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>, </FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;USER&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).build());</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.add(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>User</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>withUsername</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;user&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>). password(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;pass&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>). roles(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;USER&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).build());</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>InMemoryUserDetailsManager(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO AUTHENTICATION WITH DATABASE(JPA) SERVICE</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Autowired </FONT></FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #aecf00">MyUserDetailsService</SPAN></FONT></FONT></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>uds</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Bean</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>AuthenticationProvider </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>authenticationProvider</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>() {</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>DaoAuthenticationProvider authenticationProvider </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>DaoAuthenticationProvider();</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>authenticationProvider</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.setUserDetailsService(</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>uds</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);              </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// ** ROLE SET IN SERVICE MUST START WITH ROLL_</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">        </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>authenticationProvider</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.setPasswordEncoder(getPasswordEncoder());</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>authenticationProvider</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO AUTHORIZATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Bean</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>protected </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>SecurityFilterChain </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>configure</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>HttpSecurity </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>http) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Exception </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>{ </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// deals with authorization</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">        </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>http    .authorizeHttpRequests((requests) -&gt; requests</FONT></FONT></FONT>
<FONT COLOR="#080808">                        <FONT FACE="Consolas, monospace"><FONT SIZE=2>.requestMatchers(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;/admin&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).hasRole(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ADMIN&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">                        <FONT FACE="Consolas, monospace"><FONT SIZE=2>.requestMatchers(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;/user&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).hasAnyRole(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;USER&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>, </FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ADMIN&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">                        <FONT FACE="Consolas, monospace"><FONT SIZE=2>.anyRequest().authenticated()</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>.formLogin((form)   -&gt; form.permitAll() )</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>.logout(   (logout) -&gt; logout.permitAll());</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>http.build();</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c">    <FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// DO </I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I><SPAN STYLE="background: #ccffff">ENCODING</SPAN></I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Bean</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>PasswordEncoder </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>getPasswordEncoder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(){</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>NoOpPasswordEncoder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>getInstance</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(); </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// this is a clear text encoding password</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=3 STYLE="font-size: 13pt"><U><B>CONFIGURE JPA CONNECTIONS TO DATABASE</B></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">1. IMPLEMENT INTERFACE </SPAN></U><FONT COLOR="#000000"><U><SPAN STYLE="background: #ffff00">UserDetailsService</SPAN></U></FONT></FONT></FONT></FONT>
<FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Service</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000"><SPAN STYLE="background: #aecf00">MyUserDetailsService</SPAN></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#0033b3">implements </FONT><FONT COLOR="#000000">UserDetailsService </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Autowired</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #cccc99">UserRepository</SPAN></FONT></FONT></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userRepository</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Override</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>UserDetails </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>loadUserByUsername</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>userName) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>UsernameNotFoundException </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>{</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Optional</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #00ffff">UserDB</SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt; </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>user </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= </FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userRepository</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.findByUserName(userName);                </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// SELECT USER BY NAME </I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">        </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>user</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.orElseThrow(() -&gt; </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>UsernameNotFoundException(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;Not found: &quot; </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>+ </FONT></FONT><FONT COLOR="#851691"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userName </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>));</FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// IF ERROR RETURN ERR</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">        </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>user</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.map(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #ffccff">MyUserDetails</SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>::</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).get();                                       </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>// MAP USER TO OBJECT   </I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">    </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">2. </SPAN></U></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">EXTEND JPA REPOSITORY</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#0033b3"><SPAN STYLE="text-decoration: none"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent">public interface </SPAN></FONT></FONT></SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #cccc99">UserRepository</SPAN></FONT></FONT></SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><SPAN STYLE="background: transparent"> </SPAN></SPAN></FONT><FONT COLOR="#0033b3"><SPAN STYLE="text-decoration: none"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent">extends </SPAN></FONT></FONT></SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent">CrudRepository&lt;</SPAN></FONT></FONT></SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #00ffff">UserDB</SPAN></FONT></FONT></SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="text-decoration: none"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent">, Integer&gt; {</SPAN></FONT></FONT></SPAN></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Optional</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>UserDB</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt; </FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>findByUserName</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>userName);</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>

<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">3. </SPAN></U><FONT COLOR="#000000"><U><SPAN STYLE="background: #ffff00">CREATE ENTITY (JPA CONNECTION TO DB TABLE)</SPAN></U></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent"><FONT COLOR="#9e880d">@Entity </FONT><FONT COLOR="#8c8c8c"><I>// This tells Hibernate to make a table out of this class</I></FONT></SPAN></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@Table</FONT>(name = <FONT COLOR="#067d17">&quot;User_db&quot;</FONT>)</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000"><SPAN STYLE="background: #00ffff">UserDB</SPAN></FONT><FONT COLOR="#000000"> </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@Id</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2>@GeneratedValue</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(strategy=</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>GenerationType</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>AUTO</I></FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Integer </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>id</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userName</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>password</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>private boolean </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>active</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>roles</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">4. IMPLEMENT UserDetails</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent"><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000"><SPAN STYLE="background: #ffccff">MyUserDetails</SPAN></FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#0033b3">implements </FONT><FONT COLOR="#000000">UserDetails {</FONT></SPAN></FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userName</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>String </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>password</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>boolean </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>active</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Collection</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>GrantedAuthority</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt; </FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>authorities</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>public </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>MyUserDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>UserDB </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>user){</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>this</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userName </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= user.getUserName();</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>this</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>password </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= user.getPassword();</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>this</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>active </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= user.isActive();</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>this</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>authorities </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>=  </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Arrays</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>stream</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(user.getRoles().split(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;</FONT></FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: #edfced">,</SPAN></FONT></FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>))</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>.map(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>SimpleGrantedAuthority</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>::</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">                <FONT FACE="Consolas, monospace"><FONT SIZE=2>.collect(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>Collectors</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>toList</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>());</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=3 STYLE="font-size: 13pt"><U><B><SPAN STYLE="background: transparent">CONFIGURE MYSQL CONNECTION</SPAN></B></U></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">1. POM JPA AND MYSQL</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><SPAN STYLE="background: transparent"><FONT COLOR="#000000">&lt;</FONT><FONT COLOR="#0033b3">dependency</FONT><FONT COLOR="#000000">&gt;</FONT></SPAN></FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;mysql&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;mysql-connector-java&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;/<FONT COLOR="#0033b3">dependency</FONT>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>dependency</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;org.springframework.boot&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;spring-boot-starter-data-jpa&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">  <FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>dependency</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">2. CONNECTION VIA application.properties</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#083080">sp</FONT><FONT COLOR="#083080"><FONT FACE="Consolas, monospace"><FONT SIZE=2>ring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</FONT></FONT></FONT>
<FONT COLOR="#083080"><FONT FACE="Consolas, monospace"><FONT SIZE=2>spring.datasource.url=jdbc:mysql://${MYSQL_HOST:localhost}:3306/jpayment1</FONT></FONT></FONT>
<FONT COLOR="#083080"><FONT FACE="Consolas, monospace"><FONT SIZE=2>spring.datasource.us</FONT></FONT></FONT><FONT COLOR="#083080">ername</FONT>=<FONT COLOR="#067d17">root</FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#083080">spring.datasource.password</FONT>=<FONT COLOR="#067d17">123454321</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#083080">spring.jpa.hibernate.ddl-auto</FONT>=<FONT COLOR="#00627a">update</FONT></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2><U><SPAN STYLE="background: #ffff00">3. CONNECTION VIA DataSource Bean</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2>in the future &ndash; add!</FONT></FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=3 STYLE="font-size: 13pt"><U><B><SPAN STYLE="background: transparent">CONFIGURE OTHER METHODS OF AUTHENTICATION</SPAN></B></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d"><I>@Bean  </I></FONT><FONT COLOR="#8c8c8c"><I>// IN MEMORY AUTHORIZATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public </FONT><FONT COLOR="#000000">InMemoryUserDetailsManager </FONT><FONT COLOR="#00627a">inMemoryUserDetailsManager</FONT>(){</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>List</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&lt;</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>UserDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>&gt; </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>ArrayList&lt;&gt;();</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.add(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>User</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>withUsername</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;admin&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).password(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;pass&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).roles(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ADMIN&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>, </FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;USER&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).build());</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.add(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>User</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2><I>withUsername</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;user&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>). password(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;pass&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>). roles(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;USER&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>).build());</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>InMemoryUserDetailsManager(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>userDetailsList</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@Autowired  </FONT><FONT COLOR="#8c8c8c"><I>// LDAP AUTHORIZATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public void </FONT><FONT COLOR="#00627a">configure</FONT>(<FONT COLOR="#000000">AuthenticationManagerBuilder </FONT>auth) <FONT COLOR="#0033b3">throws </FONT><FONT COLOR="#000000">Exception </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT FACE="Consolas, monospace"><FONT SIZE=2>auth    .ldapAuthentication()</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.userDnPatterns(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;uid={0},ou=people&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.groupSearchBase(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ou=groups&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.contextSource()</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.url(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;ldap://localhost:8389/dc=springframework,dc=org&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>)</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.and()</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.passwordCompare()</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.passwordEncoder(</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>BCryptPasswordEncoder())</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT FACE="Consolas, monospace"><FONT SIZE=2>.passwordAttribute(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2>&quot;userPassword&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#9e880d">@Bean  </FONT><FONT COLOR="#8c8c8c"><I>// CUSTOM MANAGER AUTHORIZATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2><FONT COLOR="#0033b3">public </FONT><FONT COLOR="#000000">AuthenticationManager </FONT><FONT COLOR="#00627a">authManager</FONT>(<FONT COLOR="#000000">HttpSecurity </FONT>http) <FONT COLOR="#0033b3">throws </FONT><FONT COLOR="#000000">Exception </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>AuthenticationManagerBuilder amb </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>= http.getSharedObject(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>AuthenticationManagerBuilder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>class</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>amb</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.authenticationProvider(</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2>customAuthProvider</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>);</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2>return </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2>amb</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2>.build();</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2>}</FONT></FONT></FONT>


<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=3 STYLE="font-size: 13pt"><U><B><SPAN STYLE="background: transparent">WORKING WITH jwt EXAMPLE (OLD WAY)</SPAN></B></U></FONT></FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: #ffff00">1. ADD THE DEPENDENCIES TO THE POM</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;dependency&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;javax.xml.bind&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;jaxb-api&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">version</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;2.3.0&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">version</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;/<FONT COLOR="#0033b3">dependency</FONT>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;<FONT COLOR="#0033b3">dependency</FONT>&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;io.jsonwebtoken&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">groupId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;jjwt&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">artifactId</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">version</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;0.9.1&lt;/</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">version</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&gt;</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;/<FONT COLOR="#0033b3">dependency</FONT>&gt;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><U><SPAN STYLE="background: #ffff00">2. SET JWT UTILS FROM THIS    <A HREF="https://github.com/koushikkothagal/spring-security-jwt/blob/master/src/main/java/io/javabrains/springsecurityjwt/util/JwtUtil.java"><FONT COLOR="#0066cc"><SPAN STYLE="background: transparent">LINK</SPAN></FONT></A></SPAN></U></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="text-decoration: none"><SPAN STYLE="background: transparent">allow us utils of working with JWT such as</SPAN></SPAN></FONT></FONT></FONT><SPAN STYLE="text-decoration: none"><SPAN STYLE="background: transparent"> </SPAN></SPAN><FONT COLOR="#00627a"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="text-decoration: none">createToken </SPAN></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="text-decoration: none"><SPAN STYLE="background: transparent">and</SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#00627a"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="text-decoration: none"> </SPAN></FONT></FONT><FONT COLOR="#00627a"><FONT SIZE=2 STYLE="font-size: 10pt">validateToken</FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: #ffff00">3. SET THE SERVICE TO AUTHENTICATE USERS</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><B><SPAN STYLE="background: transparent">@Service</SPAN></B></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000">MyUserDetailsService </FONT><FONT COLOR="#0033b3">implements </FONT><FONT COLOR="#000000">UserDetailsService </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">    <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Override</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">    </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UserDetails </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">loadUserByUsername</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">String </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userName) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UsernameNotFoundException </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#080808">        <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">return new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">User(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;foo&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">,</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;foo&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">,</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">ArrayList&lt;&gt;()); </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// simple fixed user</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">     </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: #ffff00">4. SET WEB SECURITY ADAPTER</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: transparent">@Configuration</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@EnableWebSecurity</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000">SecurityConfiguration </FONT><FONT COLOR="#0033b3">extends </FONT><FONT COLOR="#000000">WebSecurityConfigurerAdapter </FONT>{</FONT></FONT></FONT>

<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired </FONT></FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">MyUserDetailsService </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">uds</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired </FONT></FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">private </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">JwtRequestFilter </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwtRequestFilter</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// DO AUTHENTICATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">   </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">   </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">public void </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">configure</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">AuthenticationManagerBuilder </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">auth) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">Exception </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">auth.userDetailsService(</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">uds</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">);</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">   </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>

<FONT COLOR="#080808">   <FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// DO AUTHORIZATION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">   </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Override</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">   </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">protected void </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">configure</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">HttpSecurity </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">http) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">Exception </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// 1. DISABLE CROSS</I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">      </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">http.csrf().disable().</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// 2. IF autheticate, PERMIT ALL</I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">      </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authorizeRequests().antMatchers(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;/authenticate&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">).permitAll().</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// 3. IF ELSE AUTHENTICATE</I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">      </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">anyRequest().authenticated()</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// 4. SET SESSION MANAGMENT TO STATELESS, WITH JWT NO USE FOR SESSION</I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">      </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.and().sessionManagement().sessionCreationPolicy(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">SessionCreationPolicy</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>STATELESS</I></FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">);</FONT></FONT></FONT>
<FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// 5. ADD FILTER</I></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">      </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">http.addFilterBefore(</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwtRequestFilter</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">, </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UsernamePasswordAuthenticationFilter</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">class</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">);</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808">   </FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Bean  </FONT></FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// DO ENCODING</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">   </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">PasswordEncoder </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">passwordEncoder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">() {</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">return </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">NoOpPasswordEncoder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>getInstance</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(); </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// this is a clear text encoding password</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">   </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Bean</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">   </FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Override     </FONT></FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// ADDED THE controller ALLOW TO GET AuthenticationManager AS Autowire</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">   </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">AuthenticationManager </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authenticationManagerBean</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">() </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">Exception </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">return super</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.authenticationManagerBean();</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: #ffff00">5. ADD FILTER TO FILTER NON AUTHORISED REQUESTS </SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: #ffff00"><FONT COLOR="#9e880d"><SPAN STYLE="font-weight: normal"><SPAN STYLE="background: transparent">@Component</SPAN></SPAN></FONT></SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0033b3">public class </FONT><FONT COLOR="#000000">JwtRequestFilter </FONT><FONT COLOR="#0033b3">extends </FONT><FONT COLOR="#000000">OncePerRequestFilter </FONT>{</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">JwtUtil </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwtUtil</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">   </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">MyUserDetailsService </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetailsService</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Override</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#9e880d">   </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">protected void </FONT></FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">doFilterInternal</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">HttpServletRequest </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">request, </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">HttpServletResponse </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">response, </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">FilterChain </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">chain)</FONT></FONT></FONT>
<FONT COLOR="#080808">         <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">ServletException</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">, </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">IOException </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">final </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">String requestTokenHeader </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">= request.getHeader(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;Authorization&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">); </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// REQUEST SHOULD COME WITH THIS HEADER</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">      </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">String </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">username = </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">null</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">String </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwt = </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">null</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">if </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">requestTokenHeader </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">!= </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">null </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&amp;&amp; </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">requestTokenHeader</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.startsWith(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;Bearer &quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">)) { </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// HEADER SHOULD START WITH THIS PRE</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">         </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwt = </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">requestTokenHeader</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.substring(</FONT></FONT><FONT COLOR="#1750eb"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">7</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">);</FONT></FONT></FONT>
<FONT COLOR="#080808">         <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">username = </FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwtUtil</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.extractUsername(jwt);</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">if </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(username != </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">null</FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#0033b3">       </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&amp;&amp; </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">SecurityContextHolder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>getContext</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">().getAuthentication() == </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">null</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">) { </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// IF EXIST , PASS</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">         </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UserDetails userDetails </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">= </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">this</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetailsService</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.loadUserByUsername(username);</FONT></FONT></FONT>
<FONT COLOR="#080808">         <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">if </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">jwtUtil</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.validateToken(jwt, </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">)) { </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// IF HEADER VALID , CREATE TOKEN FOR SESSION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">            </FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UsernamePasswordAuthenticationToken upat </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">= </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UsernamePasswordAuthenticationToken(</FONT></FONT></FONT>
<FONT COLOR="#080808">                  <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">, </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">null</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">, </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.getAuthorities());</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">upat</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.setDetails(</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">WebAuthenticationDetailsSource().buildDetails(request));</FONT></FONT></FONT>
<FONT COLOR="#080808">            <FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">SecurityContextHolder</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>getContext</I></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">().setAuthentication(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">upat</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">); </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>//SET TOKEN TO SESSION</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">         </FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">chain.doFilter(request, response);</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><U><SPAN STYLE="background: #ffff00">6. CREATE CONTORLLER TO AUTHENTICATE BY USER AND PASS AND RETURN JWT TOKEN</SPAN></U></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=3 STYLE="font-size: 13pt"><SPAN STYLE="background: transparent"><FONT COLOR="#9e880d"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired </FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2 STYLE="font-size: 10pt">AuthenticationManager </FONT></FONT><FONT COLOR="#871094"><FONT SIZE=2 STYLE="font-size: 10pt">authenticationManager</FONT></FONT><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></SPAN></FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">MyUserDetailsService </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetailsService</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@Autowired </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">JwtUtil </FONT></FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">JwtUtil</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">;</FONT></FONT></FONT>

<FONT COLOR="#080808">   <FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@RequestMapping</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(value = </FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;/authenticate&quot;</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">, method = </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">RequestMethod</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.</FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>POST</I></FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">)</FONT></FONT></FONT>
<FONT COLOR="#080808">   <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">public </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">ResponseEntity</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&lt;?&gt; </FONT></FONT><FONT COLOR="#00627a"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authenticate</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#9e880d"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">@RequestBody </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">AuthenticationRequest </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authenticationRequest) </FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throws </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">Exception</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">try</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#080808">         <FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authenticationManager</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.authenticate( </FONT></FONT><FONT COLOR="#8c8c8c"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><I>// needs to figure out the auth process here</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT COLOR="#8c8c8c">               </FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UsernamePasswordAuthenticationToken(</FONT></FONT></FONT>
<FONT COLOR="#080808">                     <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authenticationRequest.getUsername(),</FONT></FONT></FONT>
<FONT COLOR="#080808">                     <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">authenticationRequest.getPassword())</FONT></FONT></FONT>
<FONT COLOR="#080808">         <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">);</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT><FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">catch</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">BadCredentialsException </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">e){</FONT></FONT></FONT>
<FONT COLOR="#080808">         <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">throw new </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">Exception(</FONT></FONT><FONT COLOR="#067d17"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">&quot;Incorrect username or password&quot; </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">, e);</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">final </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">UserDetails userDetails </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">= </FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetailsService</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.loadUserByUsername(authenticationRequest.getUsername());</FONT></FONT></FONT>
<FONT COLOR="#080808">      <FONT COLOR="#0033b3"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">final </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">String jwt </FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">= </FONT></FONT><FONT COLOR="#871094"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">JwtUtil</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">.generateToken(</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">userDetails</FONT></FONT></FONT><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">);</FONT></FONT></FONT>
<FONT COLOR="#080808"><FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0033b3">return </FONT><FONT COLOR="#000000">ResponseEntity</FONT>.<I>ok</I>(<FONT COLOR="#0033b3">new </FONT>AuthenticationResponse(<FONT COLOR="#000000">jwt</FONT>)); <FONT COLOR="#8c8c8c"><I>//RETURN jwt TOKEN FOR SESSION</I></FONT></FONT></FONT></FONT>

<FONT COLOR="#080808">   <FONT FACE="Consolas, monospace"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>










</PRE>
</BODY>
</HTML>